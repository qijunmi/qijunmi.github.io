
<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Lesson 6: True Type Fonts with SDL_ttf</title>
	
		<meta name="description" content="font-tastic!">
	
    <meta name="author" content="Will Usher">

	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
	<![endif]-->

	<link href="/assets/bootstrap3/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/syntax.css" rel="stylesheet">
	<link href="/assets/custom.css" rel="stylesheet">
	<link rel="shortcut icon" href="/assets/img/identicon.ico">
	<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
</head>
<body>
	<div class="navbar navbar-inverse navbar-static-top" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="sr-only">Toggle nav</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/">Will Usher</a>
			</div>
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav navbar-right">
					
					
					


  
    
      
        
      	<li><a href="/pages/sdl2">SDL2 Tutorials</a></li>
      	
      
    
  
    
      
        
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
        
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  





				</ul>
			</div><!--/.nav-collapse -->
		</div>
	</div>

	<div class="container content">
			
<div class="page-header">
	<h1>Lesson 6: True Type Fonts with SDL_ttf <small>font-tastic!</small></h1>
</div>

<div class="col-md-12">
	<div class="col-md-9">
		<p>In this lesson we&#39;ll see how to perform basic True Type font rendering with the SDL<em>ttf extension library.
Setting up the library is identical to what we did in
<a href="/sdl2%20tutorials/2013/08/18/lesson-3-sdl-extension-libraries">Lesson 3</a> for SDL</em>image, but just replace
&quot;image&quot; with &quot;ttf&quot; (Windows users should also copy the included freetype dll over). So <a href="http://www.libsdl.org/projects/SDL_ttf/">download SDL_ttf</a>,
take a peek at the <a href="http://www.libsdl.org/projects/SDL_ttf/docs/index.html">documentation</a>, and let&#39;s get started!</p>

<!--more-->

<p>The first thing we&#39;ll need after the library is a font to render our text with. I made a pretty awful font using
<a href="http://www.pentacom.jp/pentacom/bitfontmaker2/">BitFontMaker</a> which you can
<a href="https://github.com/Twinklebear/TwinklebearDev-Lessons/raw/master/res/Lesson6/sample.ttf">download from the repository</a>, or if you have some other font you&#39;d like to use that&#39;s fine too. My font only provides the basic ASCII characters, so if you try to render non-ASCII characters they probably won&#39;t show up.
The code for this lesson will build off of what we wrote for Lesson 5, so if you don&#39;t have that to start from grab it off <a href="https://github.com/Twinklebear/TwinklebearDev-Lessons/tree/master/Lesson5">Github</a>, the image being
loaded and the clips calculation and drawing will be replaced with what we learn here.</p>

<h2>Rendering Text</h2>

<p>SDL<em>ttf provides a few different ways for rendering text with varying speed/quality trade-offs, along with the
ability to render UTF8 and Unicode strings and glyphs. The <a href="http://www.libsdl.org/projects/SDL_ttf/docs/SDL_ttf_42.html#SEC42">documentation</a> provides a nice overview of the different rendering methods available, so it&#39;s worth reading
and knowing when you&#39;d want to use which one depending on your speed/quality requirements. For this lesson
we&#39;ll be using `TTF</em>RenderText_Blended<code>since we don&#39;t really have any time constraints and would like our
text to be stylin&#39;. The various render text functions also take an RGB [</code>SDL<em>Color`](http://wiki.libsdl.org/SDL</em>Color)
which we can use to pick the text color to draw.</p>

<p>Unfortunately SDL_ttf can only render to a surface so we&#39;ll have to run an additional
step after rendering the text to create a texture from it that we can draw with our renderer. Of course we&#39;ll also
need to load a font to use, which is done with <a href="http://www.libsdl.org/projects/SDL_ttf/docs/SDL_ttf_14.html#SEC14"><code>TTF_OpenFont</code></a>, where we can also specify the font size that we want.</p>

<h2>Writing Our <code>renderText</code> Function</h2>

<p>To make this easy for ourselves we&#39;ll create a function <code>renderText</code> that will take a message, font file containing
the TTF font we want to use, the color and size we want and the renderer to load the final texture into. The
function will then open the font, render the text, convert it to a texture and return the texture. Since there
could be some problems along the way we&#39;ll also need to check each of our library calls for errors and handle
them appropriately, i.e. clean up any resources, log the error and return <code>nullptr</code> so we know something bad happened.
SDL<em>ttf will report any of its errors through `SDL</em>GetError<code>so we can continue to use</code>logSDLError`
for error logging.</p>

<p>With those requirements in mind, let&#39;s write our <code>renderText</code> function:</p>

<div class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cm">/**</span>
<span class="cm">* Render the message we want to display to a texture for drawing</span>
<span class="cm">* @param message The message we want to display</span>
<span class="cm">* @param fontFile The font we want to use to render the text</span>
<span class="cm">* @param color The color we want the text to be</span>
<span class="cm">* @param fontSize The size we want the font to be</span>
<span class="cm">* @param renderer The renderer to load the texture in</span>
<span class="cm">* @return An SDL_Texture containing the rendered message, or nullptr if something went wrong</span>
<span class="cm">*/</span>
<span class="n">SDL_Texture</span><span class="o">*</span> <span class="nf">renderText</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">fontFile</span><span class="p">,</span>
    <span class="n">SDL_Color</span> <span class="n">color</span><span class="p">,</span> <span class="kt">int</span> <span class="n">fontSize</span><span class="p">,</span> <span class="n">SDL_Renderer</span> <span class="o">*</span><span class="n">renderer</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//Open the font</span>
    <span class="n">TTF_Font</span> <span class="o">*</span><span class="n">font</span> <span class="o">=</span> <span class="n">TTF_OpenFont</span><span class="p">(</span><span class="n">fontFile</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">fontSize</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">font</span> <span class="o">==</span> <span class="k">nullptr</span><span class="p">){</span>
        <span class="n">logSDLError</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span> <span class="s">&quot;TTF_OpenFont&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">nullptr</span><span class="p">;</span>
    <span class="p">}</span>    
    <span class="c1">//We need to first render to a surface as that&#39;s what TTF_RenderText</span>
    <span class="c1">//returns, then load that surface into a texture</span>
    <span class="n">SDL_Surface</span> <span class="o">*</span><span class="n">surf</span> <span class="o">=</span> <span class="n">TTF_RenderText_Blended</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">message</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">color</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">surf</span> <span class="o">==</span> <span class="k">nullptr</span><span class="p">){</span>
        <span class="n">TTF_CloseFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span>
        <span class="n">logSDLError</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span> <span class="s">&quot;TTF_RenderText&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">nullptr</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">SDL_Texture</span> <span class="o">*</span><span class="n">texture</span> <span class="o">=</span> <span class="n">SDL_CreateTextureFromSurface</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">surf</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">texture</span> <span class="o">==</span> <span class="k">nullptr</span><span class="p">){</span>
        <span class="n">logSDLError</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span> <span class="s">&quot;CreateTexture&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">//Clean up the surface and font</span>
    <span class="n">SDL_FreeSurface</span><span class="p">(</span><span class="n">surf</span><span class="p">);</span>
    <span class="n">TTF_CloseFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">texture</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p><br /></p>

<h2>Performance Warning</h2>

<p>An important thing to note here is that each time we want to render a message we re-open and close the font, which is
ok for this case since we&#39;re only rendering one message a single time, but if we wanted to render a lot of text
and/or render text frequently it would be a much better idea to keep the font open for as long as we needed it.
Our version of <code>renderText</code> for this more common use case would take a <code>TTF_Font*</code> instead of the font file name,
and wouldn&#39;t open or close the font, as the font&#39;s lifetime would be managed separately.</p>

<h2>Initializing SDL_ttf</h2>

<p>As with SDL we need to initialize the library before we can use it. This is done via
<a href="http://www.libsdl.org/projects/SDL_ttf/docs/SDL_ttf_8.html#SEC8"><code>TTF_Init</code></a> which will return 0 on success. To
initialize SDL_ttf we just call this function after initializing SDL and check the return value to make sure it went ok.</p>

<div class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="k">if</span> <span class="p">(</span><span class="n">TTF_Init</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span>
    <span class="n">logSDLError</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span> <span class="s">&quot;TTF_Init&quot;</span><span class="p">);</span>
    <span class="n">SDL_Quit</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p><br /></p>

<h2>Using <code>renderText</code></h2>

<p>With our handy <code>renderText</code> function we can render our message with a very simple call. For this lesson I&#39;ve chosen
to render &quot;TTF fonts are cool!&quot; in white at a font size of 64 using the terrible font I made earlier. We can
then query the width and height the same as for any other texture and compute the x/y coordinates to draw the
message centered in the window.</p>

<div class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">resPath</span> <span class="o">=</span> <span class="n">getResourcePath</span><span class="p">(</span><span class="s">&quot;Lesson6&quot;</span><span class="p">);</span>
<span class="c1">//We&#39;ll render the string &quot;TTF fonts are cool!&quot; in white</span>
<span class="c1">//Color is in RGBA format</span>
<span class="n">SDL_Color</span> <span class="n">color</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span> <span class="p">};</span>
<span class="n">SDL_Texture</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="n">renderText</span><span class="p">(</span><span class="s">&quot;TTF fonts are cool!&quot;</span><span class="p">,</span> <span class="n">resPath</span> <span class="o">+</span> <span class="s">&quot;sample.ttf&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">renderer</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">image</span> <span class="o">==</span> <span class="k">nullptr</span><span class="p">){</span>
    <span class="n">cleanup</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">window</span><span class="p">);</span>
    <span class="n">TTF_Quit</span><span class="p">();</span>
    <span class="n">SDL_Quit</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//Get the texture w/h so we can center it in the screen</span>
<span class="kt">int</span> <span class="n">iW</span><span class="p">,</span> <span class="n">iH</span><span class="p">;</span>
<span class="n">SDL_QueryTexture</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">iW</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">iH</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">SCREEN_WIDTH</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">iW</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">iH</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span></code></pre></div>

<p><br /></p>

<h2>Drawing the Text</h2>

<p>Finally we can draw the texture as we&#39;ve done before with our <code>renderTexture</code> function.</p>

<div class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="c1">//Note: This is within the program&#39;s main loop</span>
<span class="n">SDL_RenderClear</span><span class="p">(</span><span class="n">renderer</span><span class="p">);</span>
<span class="c1">//We can draw our message as we do any other texture, since it&#39;s been</span>
<span class="c1">//rendered to a texture</span>
<span class="n">renderTexture</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="n">SDL_RenderPresent</span><span class="p">(</span><span class="n">renderer</span><span class="p">);</span></code></pre></div>

<p><br /></p>

<p>If everything goes well you should see something like this rendered to the screen:</p>

<p><br />
<img class="centered" width="600" height="auto" src="/assets/img/lesson_6/ttf_fonts_example.png">
<br /></p>

<h2>End of Lesson 6</h2>

<p>That&#39;s it for our quick look at SDL_ttf! Don&#39;t forget to check out the <a href="http://www.libsdl.org/projects/SDL_ttf/docs/index.html">documentation</a> for the library to see what else it&#39;s capable of. As always, if you run into any issues with
the lesson feel free to post a comment below. I&#39;ll see you again soon in Lesson 7: Taking Advantage of Classes.</p>

	</div>
	<div class="col-md-3">
		<h4><a href="/pages/sdl2/">Tutorial Index</a></h4>
		<h4>Helpful Links</h4>
		<a href="http://wiki.libsdl.org/moin.fcg/FrontPage">SDL Documentation</a>
		<br />
		<a href="http://forums.libsdl.org/">SDL Forums</a>
		<br />
		<a href="irc://irc.freenode.net/SDL">IRC: #SDL on freenode</a>
		<br />
		<a href="http://en.cppreference.com/w/">C++ Reference</a>
		<br />
		<a href="https://github.com/Twinklebear/TwinklebearDev-Lessons">Code on Github</a>
		<p>Published: 18 December 2013
	</div>
</div>
<div class="col-md-12 comments">
	


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'twinklebeargithub'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




</div>




	</div>

	
	<script src="https://code.jquery.com/jquery.js"></script>
	<script src="/assets/bootstrap3/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
</body>
</html>



